<!DOCTYPE html>
<html>
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    #mindmap-root {
      width: 100%;
      height: 600px;
      background: #ffffff;
      border-radius: 8px;
      overflow: hidden;
    }
    .node-circle {
      transition: all 0.3s ease;
    }
    .node-circle:hover {
      fill: #f3f4f6;
    }
    .control-button {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 8px 16px;
      cursor: pointer;
      font-family: Arial, sans-serif;
      font-size: 14px;
      transition: all 0.2s ease;
    }
    .control-button:hover {
      background: #f3f4f6;
    }
    .connection-line {
      transition: stroke 0.3s ease;
    }
    .connection-line:hover {
      stroke: #d1d5db;
    }
  </style>
</head>
<body>
  <div id="mindmap-root"></div>

  <script type="text/babel">
    const BASE_URL = 'https://www.parkjason.com';
    
    const siteStructure = {
      id: 'root',
      label: 'Home',
      path: `${BASE_URL}`,
      children: [
        {
          id: 'about',
          label: 'About',
          path: `${BASE_URL}/about`
        },
        {
          id: 'work',
          label: 'Work',
          path: `${BASE_URL}/work`
        },
        {
          id: 'contact',
          label: 'Contact',
          path: `${BASE_URL}/contact`
        }
      ]
    };

    const MindMap = () => {
      const [dimensions, setDimensions] = React.useState({ width: 800, height: 600 });
      const [transform, setTransform] = React.useState({ x: 0, y: 0, scale: 1 });
      const [isDragging, setIsDragging] = React.useState(false);
      const [dragStart, setDragStart] = React.useState({ x: 0, y: 0 });
      const [isTransitioning, setIsTransitioning] = React.useState(false);
      const svgRef = React.useRef(null);

      React.useEffect(() => {
        const updateDimensions = () => {
          const container = document.getElementById('mindmap-root');
          if (container) {
            setDimensions({
              width: container.clientWidth,
              height: container.clientHeight
            });
          }
        };

        updateDimensions();
        window.addEventListener('resize', updateDimensions);
        return () => window.removeEventListener('resize', updateDimensions);
      }, []);

      const calculateNodePositions = () => {
        const radius = 150;
        const centerNode = { id: 'root', label: 'Home', x: 0, y: 0, path: siteStructure.path };
        const childNodes = siteStructure.children.map((child, index) => {
          const angle = (index * 2 * Math.PI / siteStructure.children.length) - Math.PI / 2;
          return {
            id: child.id,
            label: child.label,
            x: Math.cos(angle) * radius,
            y: Math.sin(angle) * radius,
            path: child.path
          };
        });
        return [centerNode, ...childNodes];
      };

      const nodes = calculateNodePositions();

      const handleWheel = (e) => {
        if (isTransitioning) return;
        e.preventDefault();
        const delta = -e.deltaY;
        const scaleFactor = 1.05;
        
        const svgBounds = svgRef.current.getBoundingClientRect();
        const mouseX = e.clientX - svgBounds.left;
        const mouseY = e.clientY - svgBounds.top;

        setTransform(prev => {
          const newScale = delta > 0 ? prev.scale * scaleFactor : prev.scale / scaleFactor;
          const boundedScale = Math.min(Math.max(newScale, 0.5), 2);
          
          const scaleChange = boundedScale - prev.scale;
          const newX = prev.x - (mouseX - dimensions.width / 2) * scaleChange;
          const newY = prev.y - (mouseY - dimensions.height / 2) * scaleChange;

          return {
            x: newX,
            y: newY,
            scale: boundedScale
          };
        });
      };

      const handleMouseDown = (e) => {
        if (e.button === 0) {
          setIsDragging(true);
          setDragStart({ x: e.clientX - transform.x, y: e.clientY - transform.y });
        }
      };

      const handleMouseMove = (e) => {
        if (isDragging) {
          setTransform(prev => ({
            ...prev,
            x: e.clientX - dragStart.x,
            y: e.clientY - dragStart.y
          }));
        }
      };

      const handleMouseUp = () => {
        setIsDragging(false);
      };

      const handleNodeClick = (path) => {
        if (!isDragging) {
          try {
            let topWindow = window;
            while (topWindow.parent !== topWindow) {
              topWindow = topWindow.parent;
            }
            topWindow.location.href = path;
          } catch (e) {
            window.location.href = path;
          }
        }
      };

      const handleZoomButton = (direction) => {
        if (isTransitioning) return;
        const scaleFactor = 1.2;
        setTransform(prev => {
          const newScale = direction === 'in' ? prev.scale * scaleFactor : prev.scale / scaleFactor;
          return {
            ...prev,
            scale: Math.min(Math.max(newScale, 0.5), 2)
          };
        });
      };

      const resetView = () => {
        setIsTransitioning(true);
        setTransform({ x: 0, y: 0, scale: 1 });
        setTimeout(() => setIsTransitioning(false), 500);
      };

      return (
        <div style={{ width: '100%', height: '100%', position: 'relative' }}>
          {/* Controls */}
          <div style={{
            position: 'absolute',
            top: '1rem',
            right: '1rem',
            zIndex: 10,
            display: 'flex',
            gap: '0.5rem'
          }}>
            <button
              className="control-button"
              onClick={() => handleZoomButton('out')}
              disabled={isTransitioning}
            >
              âˆ’
            </button>
            <button
              className="control-button"
              onClick={() => handleZoomButton('in')}
              disabled={isTransitioning}
            >
              +
            </button>
            <button
              className="control-button"
              onClick={resetView}
              disabled={isTransitioning}
            >
              Reset View
            </button>
          </div>

          <div
            style={{ width: '100%', height: '100%' }}
            onWheel={handleWheel}
            onMouseDown={handleMouseDown}
            onMouseMove={handleMouseMove}
            onMouseUp={handleMouseUp}
            onMouseLeave={handleMouseUp}
          >
            <svg
              ref={svgRef}
              viewBox={`${-dimensions.width/4} ${-dimensions.height/4} ${dimensions.width/2} ${dimensions.height/2}`}
              style={{ width: '100%', height: '100%', cursor: isDragging ? 'grabbing' : 'grab' }}
            >
              <g
                transform={`translate(${transform.x},${transform.y}) scale(${transform.scale})`}
                style={{ transition: isTransitioning ? 'transform 0.5s ease' : 'none' }}
              >
                {/* Connections */}
                {nodes.slice(1).map(node => (
                  <line
                    key={`line-${node.id}`}
                    x1="0"
                    y1="0"
                    x2={node.x}
                    y2={node.y}
                    className="connection-line"
                    stroke="#e5e7eb"
                    strokeWidth="2"
                  />
                ))}

                {/* Nodes */}
                {nodes.map((node) => (
                  <g
                    key={node.id}
                    transform={`translate(${node.x},${node.y})`}
                    onClick={() => handleNodeClick(node.path)}
                    style={{ cursor: 'pointer' }}
                  >
                    <circle
                      r="40"
                      className="node-circle"
                      fill="white"
                      stroke="#d1d5db"
                      strokeWidth="2"
                    />
                    <text
                      dy=".3em"
                      textAnchor="middle"
                      fill="#374151"
                      style={{
                        fontSize: '14px',
                        fontFamily: 'Work Sans, sans-serif',
                        pointerEvents: 'none'
                      }}
                    >
                      {node.label}
                    </text>
                  </g>
                ))}
              </g>
            </svg>
          </div>
        </div>
      );
    };

    ReactDOM.render(<MindMap />, document.getElementById('mindmap-root'));
  </script>
</body>
</html>
